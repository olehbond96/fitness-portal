{% extends "training/base.html" %}

{% block title %}{{ workoutplan.title }} - Fitness Portal{% endblock %}

{% block content %}
<h1>Workout Plan: {{ workoutplan.title }}</h1>

<div class="card">
    <div class="card-body">
        <p><strong>Athlete:</strong>
            <a href="{% url 'training:athlete-detail' pk=workoutplan.athlete.pk %}">
                {{ workoutplan.athlete }}
            </a>
        </p>
        <p><strong>Trainer:</strong>
            <a href="{% url 'training:trainer-detail' pk=workoutplan.trainer.pk %}">
                {{ workoutplan.trainer.username }}
            </a>
        </p>
        <p><strong>Period:</strong> {{ workoutplan.start_date }} to {{ workoutplan.end_date }}</p>
        <p><strong>Created:</strong> {{ workoutplan.created_at }}</p>
        <hr>
        <p><strong>Description:</strong></p>
        <p>{{ workoutplan.description }}</p>
    </div>
</div>

<h3 class="mt-4">Related Workouts ({{ workoutplan.workouts.count }})</h3>
{% if workoutplan.workouts.all %}
<table class="table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Duration</th>
            <th>Completed</th>
            <th>Notes</th>
        </tr>
    </thead>
    <tbody>
        {% for workout in workoutplan.workouts.all %}
        <tr>
            <td>
                <a href="{% url 'training:workout-detail' pk=workout.pk %}">
                    {{ workout.date }}
                </a>
            </td>
            <td>{{ workout.duration_minutes }} min</td>
            <td>
                {% if workout.completed %}
                    <span class="badge bg-success">Yes</span>
                {% else %}
                    <span class="badge bg-warning">No</span>
                {% endif %}
            </td>
            <td>{{ workout.notes|truncatewords:10 }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No workouts recorded for this plan yet.</p>
{% endif %}

<div class="mt-3">
    <a href="{% url 'training:workout-plan-update' pk=workoutplan.pk %}" class="btn btn-warning">
        Update
    </a>
    <a href="{% url 'training:workout-plan-delete' pk=workoutplan.pk %}" class="btn btn-danger">
        Delete
    </a>
    <a href="{% url 'training:workout-plan-list' %}" class="btn btn-secondary">
        Back to list
    </a>
</div>
{% endblock %}